---
title: "CITS4403_simulation_study"
output: html_document
date: '2024-10-01'
---


#Load Libraries
```{r}
library(dplyr)
library(ggplot2)
library(shiny)
library(GGally)

```


#Data Preparation

```{r}
overall_stats <- read.csv("overall_stats.csv", header=T)
overall_stats <- na.omit(overall_stats)
str(overall_stats)
summary(overall_stats)
head(overall_stats)
```

```{r}
infected_person_stats <- read.csv("infected_person_stats.csv", header=T)
str(infected_person_stats)
summary(infected_person_stats)
head(infected_person_stats)
infected_person_stats
```

```{r}
infected_person_stats$clustering_coef <- infected_person_stats$Uninfected.Count.Near / infected_person_stats$Total.Squares.Visited

infected_df <- with(infected_person_stats,data.frame(timeStep = as.factor(Time.Step),
                                                     xCoord = as.integer(Infected.X),
                                                     yCoord = as.integer(Infected.Y),
                                                     Uninfected.Count.Near,
                                                     Total.Squares.Visited,
                                                     clustering_coef
                                                     ))

infected_df <-infected_df %>% mutate(across(-c(xCoord,yCoord,timeStep,clustering_coef), ~ as.integer(.)))

head(infected_df)
```

```{r}
infected_df <- na.omit(infected_df)
```

```{r}
summary(infected_df)
```

```{r}
# Calculate the average clustering coefficient per time step
avg_clustering_coef_df <- infected_df %>%
  group_by(timeStep) %>%
  summarize(avg_clustering_coef = mean(clustering_coef, na.rm = TRUE))

```



# Visualising Average Clustering Coefficient Over Time
```{r}
# Plot average clustering coefficient over time steps
ggplot(avg_clustering_coef_df, aes(x = as.numeric(as.character(timeStep)), y = avg_clustering_coef)) +
  geom_line(color = "blue", size = 1.2) +
  geom_point(color = "red", size = 2) +
  labs(title = "Change in Average Clustering Coefficient Over Time",
       x = "Time Step",
       y = "Average Clustering Coefficient") +
  theme_minimal()

```


# Merging Data for Analysis
```{r}
colnames(overall_stats)[1] = "timeStep"
colnames(overall_stats)


# Convert the timeStep columns to the same type in both dataframes if necessary
avg_clustering_coef_df$timeStep <- as.factor(avg_clustering_coef_df$timeStep)
# Merge overall_stats with avg_clustering_coef_df
overall_stats_with_clustering <- merge(overall_stats, avg_clustering_coef_df, by = "timeStep", all.x = TRUE)

# Check structure, summary, and first few rows of the updated dataframe
str(overall_stats_with_clustering)
summary(overall_stats_with_clustering)
head(overall_stats_with_clustering)
overall_stats_with_clustering[7,5] = 0
overall_stats_with_clustering
```

```{r}
# Generate pairwise plot using GGally::ggpairs
ggpairs(overall_stats_with_clustering, title = "Pairwise Plot of All Variables")

```


```{r}
# Load ggplot2
library(ggplot2)

# Create the plot
ggplot(overall_stats_with_clustering, aes(x = avg_clustering_coef, y = Total.Deaths)) +
  geom_point(color = "blue", size = 3) +    # Scatter plot points
  geom_smooth(method = "lm", color = "red", se = TRUE) +  # Add linear regression line with confidence interval
  labs(title = "Total Deaths vs. Average Clustering Coefficient",
       x = "Average Clustering Coefficient",
       y = "Total Deaths") +
  theme_minimal()  # Apply a clean theme

```


# Correlation Analysis
```{r}
# Correlation analysis between average clustering coefficient and total deaths
cor_test <- cor.test(overall_stats_with_clustering$avg_clustering_coef, overall_stats_with_clustering$Total.Deaths)
cor_test
```

# Linear Regression Analysis
```{r}
# Fit linear regression model
lm_model <- lm(Total.Deaths ~ avg_clustering_coef, data = overall_stats_with_clustering)
summary(lm_model)
```

#ANOVA Analysis
```{r}
# Perform ANOVA to see if total deaths differ by time step
anova_model <- aov(Total.Deaths ~ as.factor(timeStep), data = overall_stats_with_clustering)
summary(anova_model)
```

# Results

## Correlation Analysis
A Pearson correlation analysis was conducted to examine the relationship between the average clustering coefficient and total deaths. The results indicated a strong negative correlation (r = -0.7947, p = 0.03272), suggesting that higher average clustering coefficients are associated with lower total deaths. The 95% confidence interval for the correlation coefficient was [-0.9683, -0.1037], which does not include zero, further supporting the significance of this finding.

## Linear Regression Analysis
A linear regression analysis was performed to predict total deaths from the average clustering coefficient. The regression equation is as follows:

\[
\text{Total.Deaths} = 0.6842 - 3.5728 \times \text{avg_clustering_coef}
\]

The average clustering coefficient was found to be a significant predictor of total deaths (β = -3.5728, p = 0.0327). The model explained approximately 63.16% of the variance in total deaths (R² = 0.6316).

## ANOVA Analysis
An ANOVA was conducted to evaluate differences in total deaths across different time steps. The results indicated significant differences in total deaths among the time steps (F(6,5) = 8.571, p < 0.05), suggesting that the timing of the epidemic influences mortality outcomes.

These results underscore the importance of understanding clustering behavior in epidemic dynamics and its potential impact on public health outcomes.





#Conclusion
In this analysis, we investigated the relationship between the average clustering coefficient and total deaths, examining whether clustering behavior significantly impacts epidemic outcomes. We formulated hypotheses:

H0: There is no significant relationship between the average clustering coefficient and total deaths.
H1: There is a significant relationship between the average clustering coefficient and total deaths.
By conducting correlation and regression analyses, we can assess whether the data supports or rejects the null hypothesis. Additionally, ANOVA will allow us to explore differences in total deaths across various time steps.

Future work may address limitations such as the assumptions inherent in the simulation model and the potential impact of unconsidered variables.


